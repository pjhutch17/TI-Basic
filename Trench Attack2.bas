



       10 REM Trench Attack II 22/6/86
       20 REM by Peter Hutchison(c)
       30 HISC=0 :: RANDOMIZE
       40 SC,HITS=0 :: CALL MAGNIFY(4)
       50 CALL SCREEN(2):: CALL CLEAR :: BLK$=RPT$("F",16)
       60 CALL CHAR(96,BLK$,97,"80C0E0F0F8FCFEFF",98,"0103070F1F3F7FFF",99,"
       FF7F3F1F0F070301",100,"FFFEFCF8F0E0C080")
       70 REM
       80 CALL CHARPAT(97,A$,98,B$):: CALL CHAR(104,BLK$,105,A$,106,B$)
       90 CALL COLOR(9,3,1,10,4,3,3,16,3,4,16,3)
       100 RESTORE :: FOR A=1 TO 30 :: READ ROW,COL,CHR,NO :: CALL HCHAR(ROW
       ,COL,CHR,NO):: NEXT A
       110 DATA 1,1,96,32,2,1,96,2,2,3,100,1,2,30,99,1,2,31,96,2,3,1,96,1,3,
       2,100,1,3,31,99,1,3,32
       120 DATA 96,1,4,1,100,1,4,32,99,1,19,1,97,1,19,32,98,1,20,1,96,1,20,2
       ,97,1,20,31,98,1,20,32,96
       130 DATA 1,21,1,96,2,21,3,97,1,21,30,98,1,21,31,96,2,22,1,96,96,22,16
       ,106,1,22,17,105,1,23,15,106
       140 DATA 1,23,16,104,2,23,18,105,1,24,14,106,1,24,15,104,4,24,19,105,
       1
       150 CALL COLOR(5,16,1,6,16,1,7,16,1,8,16,1)
       160 DISPLAY AT(8,7):"TRENCH ATTACK II" :: DISPLAY AT(10,9):"BY ACE GA
       MES"
       170 DISPLAY AT(14,6):"PRESS FIRE TO PLAY"
       180 CALL KEY(1,FIRE,S):: IF FIRE<>18 THEN 180
       190 CALL HCHAR(8,1,32,7*32)
       200 REM Display stars
       210 CALL CHAR(33,"0000001818"):: CALL COLOR(1,16,1)
       220 FOR A=1 TO 60 :: CALL HCHAR(INT(20*RND+2),INT(26*RND+4),33):: NEX
       T A
       230 REM Set up sprites
       240 CALL CHAR(108,"000030787833070F0F0733787830000000000C1E1ECCE0F0F0
       E0CC1E1E0C")
       250 CALL CHAR(112,"00200A002A841042096015004100048002A804409280411440
       1248042004")
       260 CALL CHAR(116,"80402010080400000000040810204080010204081020000000
       00201008040201")
       270 CALL CHAR(120,"00040408111A1E1B110808040400000020201010885878D888
       1010202")
       280 CALL CHAR(124,"0000102828454640212113130C0201000000040A0AD1318142
       42E4E49820C")
       290 CALL CHAR(128,"000040E05009071C3F1F070950E040000000040E1420C070F8
       F0C020140E04")
       300 REM * Planet approach *
       310 FGT=INT(8*RND+5):: CALL DELSPRITE(ALL):: CALL SPRITE(#1,116,12,88
       ,112)
       320 CALL SPRITE(#2,120+INT(3*RND)*4,3,INT(97*RND+40),INT(193*RND+32))
       330 CALL JOYST(1,X,Y):: CALL KEY(1,FIRE,S)
       335 IF FIRE<6 THEN X=(FIRE=2)*-4+(FIRE=3)*4 :: Y=(FIRE=5)*4+(FIRE=0)*
       -4
       340 CALL MOTION(#1,SGN(-Y)*15,SGN(X)*15)
       350 IF FIRE<>18 THEN 430
       355 FOR A=1 TO 4 :: CALL SOUND(100,-5,0):: NEXT A
       360 CALL COLOR(#1,9):: CALL COINC(#1,#2,16,C):: IF C=0 THEN 410
       370 CALL PATTERN(#2,112):: CALL COLOR(#2,9):: CALL SOUND(600,-7,0,110
       ,0)
       380 FGT=FGT-1 :: SC=SC+50 :: DISPLAY AT(23,8)SIZE(LEN(STR$(SC))):STR$
       (SC)
       390 IF SC>HISC THEN DISPLAY AT(23,21)SIZE(LEN(STR$(SC))):STR$(SC):: H
       ISC=SC
       400 CALL DELSPRITE(#2):: CALL COLOR(#1,12):: IF FGT=0 THEN 530 ELSE 3
       20
       410 CALL COINC(#1,#3,16,C):: IF C=0 THEN 430
       420 SC=SC+10 :: CALL SOUND(600,-7,0,110,0):: CALL DELSPRITE(#3)
       430 CALL MOTION(#2,INT(2*RND)*7,(2-INT(3*RND+1))*15):: CALL COLOR(#1,
       12)
       440 CALL POSITION(#2,ROW,COL):: IF ROW<12 THEN CALL MOTION(#2,8,0)ELS
       E IF ROW>152 THEN CALL MOTION(#2,-8,0)
       450 IF RND>.15 OR T>0 THEN 470
       460 CALL POSITION(#2,ROW,COL):: CALL SPRITE(#3,108,10,ROW,COL,7*(ROW>
       96)-7*(ROW<96),7*(COL>128)-7*(COL<128)):: T=8
       470 CALL POSITION(#3,ROW,COL):: T=T-1 :: IF T=0 AND ROW+COL>0 THEN CA
       LL DELSPRITE(#3):: GOSUB 490 :: IF HITS=8 THEN 1160
       480 GOTO 330
       490 HITS=HITS+1 :: CALL SOUND(480,-7,0,700,15)


       495 IF HITS/2<>INT(HITS/2)THEN RETURN
       500 CALL COLOR(10,ABS(13*(HITS=2)+11*(HITS=4)+10*(HITS=6)+14*(HITS=8)
       ),3)
       510 RETURN
       520 REM Setup trench and sprites
       530 CALL DELSPRITE(ALL)
       540 CALL CHAR(120,"80472B1122446870684422112B67800002CA81088442C1C2C4
       48810A8C402")
       550 CALL CHARPAT(97,A$,98,B$)
       560 CALL CHAR(65,BLK$,66,A$,67,B$,88,BLK$,89,A$,90,B$,40,BLK$,41,A$,4
       2,B$,136,A$,137,B$)
       570 REM
       580 CALL CHAR(72,BLK$,73,RPT$("0",13)&"FFF",74,RPT$("0",9)&"FFFFFFF",
       75,"00000"&SEG$(BLK$,1,11),76,"0"&SEG$(BLK$,1,15))
       590 CALL CHAR(77,"F0"&SEG$(BLK$,1,14),78,"000F0"&SEG$(BLK$,1,10),79,"
       00000000F0FFFFFF",80,RPT$("0",12)&"FOFF")
       600 CALL COLOR(5,5,13,6,13,5,7,13,5,8,9,13,2,5,13,14,3,13):: ROW=7
       610 A$=RPT$("A",11)&"IJKL  NMOP"&RPT$("A",11):: GOSUB 670 :: A$="AAAA
       AAAIJKLHHHH  HHHHMNOPAAAAAAA" :: GOSUB 670
       615 A$="AAAIJKLHHHHHHH*  )HHHHHHHMNOPAAA" :: GOSUB 670 :: A$="JKL"&RP
       T$("H",10)&"CAAAAB"&RPT$("H",10)&"MNO"
       620 GOSUB 670 :: A$=RPT$("H",12)&"ZXXXXXXY"&RPT$("H",12):: GOSUB 670 
       :: A$=RPT$("H",11)&"CAAAAAAAAB"&RPT$("H",11)
       625 GOSUB 670 :: A$=RPT$("H",10)&"C"&RPT$("A",10)&"B"&RPT$("H",10):: 
       GOSUB 670 :: A$=RPT$("H",9)&"*"&RPT$("(",12)&RPT$("H",9)
       630 GOSUB 670 :: A$="HHHHHHHH*"&RPT$("(",14)&")HHHHHHHH" :: GOSUB 670
        :: A$="HHHHHHHC"&RPT$("A",16)&"BHHHHHHH"
       635 GOSUB 670 :: A$="HHHHHHC"&RPT$("A",18)&"BHHHHHH" :: GOSUB 670 :: 
       A$="HHHHHC"&RPT$("A",20)&"BHHHHH" :: GOSUB 670
       640 A$="!HHHC"&RPT$("A",22)&"BHHH!" :: GOSUB 670 :: A$"`!HZ"&RPT$("X"
       ,24)&"YH!`"
       650 DISPLAY AT(21,1)SIZE(28):"!"&RPT$("X",26)&"!" :: GOTO 700
       660 REM Print Subroutine
       670 FOR A=1 TO 32 :: CALL HCHAR(ROW,A,ASC(SEG$(A$,A,1))):: NEXT A
       680 ROW=ROW+1 :: RETURN
       690 REM Planet Surface
       700 SCR=0 :: MINES=INT(16*RND+5):: CALL SPRITE(#1,116,12,88,112)
       710 CALL JOYST(1,X,Y):: CALL KEY(1,FIRE,S)
       720 CALL MOTION(#1,SIGN(-Y)*11,SGN(X)*11)
       730 IF FIRE<>18 THEN 800
       740 CALL COINC(#1,#2,8,C):: CALL COLOR(#1,9):: IF C=0 THEN 780
       750 CALL PATTERN(#2,112):: CALL SOUND(-485,-6,0,140,10):: SC=SC+50 ::
        MINES=MINES-1
       760 DISPLAY AT(23,8)SIZE(LEN(STR$(SC))):STR$(SC):: CALL DELSPRITE(#2)
       :: CALL COLOR(#1,12)
       770 IF MINES=0 THEN 880 ELSE 800
       780 CALL COINC(#1,#3,16,C):: IF C=0 THEN 800
       790 CALL DELSPRITE(#3):: SC=SC+10 :: DISPLAY AT(23,8)SIZE(STR$(SC))):
       STR$(SC)
       800 IF SC>HISC THEN HISC=SC :: DISPLAY AT(23,21)SIZE(LEN(STR$(SC))):S
       TR$(SC)
       810 CALL POSITION(#2,ROW,COL):: IF RND>.7 AND ROW+COL=0 THEN CALL SPR
       ITE(#2,120,16,76,120,15,(2-INT(3*RND+1))*8)
       820 CALL POSITION(#3,ROW,COL):: IF RND>.5 AND ROW+COL=0 THEN CALL SPR
       ITE(#3,108,9,76,120,8,(2-INT(3*RND))*5)
       830 CALL POSITION(#2,ROW,COL):: IF ROW>136 AND ROW+COL>0 THEN CALL DE
       LSPRITE(#2):: GOSUB 490 :: IF HITS=8 THEN 1160
       840 CALL POSITION(#3,ROW,COL):: IF ROW>130 AND ROW+COL>0 THEN CALL DE
       LSPRITE(#3):: GOSUB 490 :: IF HITS=8 THEN 1160
       850 IF SCR=0 THEN SCR=1 :: CALL COLOR(2,9,13,8,5,13)ELSE SCR=0 :: CAL
       L COLOR(8,9,13,2,5,13)
       860 GOTO 710
       870 REM ** Generator **
       880 CALL DELSPRITE(ALL):: G1,G2=0 :: T=100
       890 CALL CHAR(120,"01020505091B336363331B09050502018040A09090D8CCC6C6
       CCD89090A04080")
       900 CALL SPRITE(#2,120,9,64,80,#3,120,9,64,144,#1,116,12,130,110)
       910 CALL JOYST(1,X,Y):: CALL KEY(1,FIRE,S)
       915 IF FIRE<6 THEN X=(FIRE=2)*-4+(FIRE=3)*4 :: Y=(FIRE=5)*4+(FIRE=0)*
       -4
       920 CALL MOTION(#1,SGN(-Y)*10,SGN(X)*10)
       930 IF FIRE<>18 THEN 970
       940 CALL COINC(#1,#2,16,C):: IF C THEN CALL SOUND(100,-6,0):: CALL CO
       LOR(#2,15):: G1=1
       950 CALL COINC(#1,#3,16,C):: IF C THEN CALL SOUND(100,-6,0):: CALL CO
       LOR(#3,15):: G2=1
       960 IF G1+G2=2 THEN SC=SC+1000 :: GOTO 990


       970 T=T-1 :: IF T>0 THEN 910 ELSE CALL DELSPRITE(ALL):: GOTO 700
       980 REM * Planet Destroyed *
       990 CALL DELSPRITE(ALL):: FOR ROW=7 TO 18 :: CALL HCHAR(R,1,32,32):: 
       NEXT ROW
       1000 CALL HCHAR(19,2,32,30):: CALL HCHAR(20,3,32,28):: CALL HCHAR(21,
       4,32,26)
       1010 CALL CHAR(33,"0000001818"):: CALL COLOR(1,16,1):: FOR A=1 TO 60 
       :: CALL HCHAR(INT(20*RND+2),INT(26*RND+4),33):: NEXT A
       1020 DISPLAY AT(23,8)SIZE(LEN(STR$(SC))):STR$(SC)
       1030 IF SC>=HISC THEN HISC=SC :: DISPLAY AT(23,21)SIZE(LEN(STR$(SC)))
       :STR$(SC)
       1040 CALL CHAR(120,"030D1F3B755FFFFFEBF77F6F3A1D0F03070F8FCFEBEF7EBF5
       FFBEFEFCF8F0C")
       1050 CALL CHAR(124,"0000172D10542028207014310C1304000040D034881A24150
       C041A4834C0308")
       1060 CALL CHAR(128,RPT$("0",13)&"1010303"&RPT$("0",24)&"80E0C08",132,
       RPT$("0",15)&"101"&RPT$("0",15)&"101"&RPT$("0",28)&"808")
       1070 CALL SPRITE(#1,120,13,72,96)
       1080 FOR DELAY=1 TO 600 :: NEXT DELAY
       1090 CALL PATTERN(#1,124):: CALL SOUND(1000,-7,0,15000,0)
       1100 FOR DELAY=1 TO 100 :: NEXT DELAY
       1110 CALL DELSPRITE(#1)
       1120 FOR DEBRIS=1 TO 14 :: CALL SPRITE(#DEBRIS,128+4*INT(2*RND),13,72
       ,96,(2-INT(3*RND+1))*INT(11*RND+5),(2-INT(3*RND+1)*INT(11*RND+5))
       1130 NEXT DEBRIS :: FOR DELAY=1 TO 1000 :: NEXT DELAY
       1140 CALL DELSPRITE(ALL):: GOTO 240
       1150 REM * End of Game *
       1160 CALL DELSPRITE(ALL):: CALL CLEAR :: CALL SCREEN(9):: CALL CHARSE
       T
       1170 DISPLAY AT(8,7):"G A M E  O V E R"
       1180 DISPLAY AT(11,5):"YOUR SCORE IS ";SC
       1190 IF SC>=HISC THEN HISC=SC :: DISPLAY AT(14,6):"A NEW HIGH SCORE!"
       1200 DISPLAY AT(21,1):"PRESS FIRE FOR ANOTHER GAME.":"  PRESS X TO QU
       IT GAME."
       1210 CALL KEY(1,FIRE,S):: IF FIRE=0 THEN END
       1220 IF FIRE<>18 THEN 1210 ELSE 40
       1230 END